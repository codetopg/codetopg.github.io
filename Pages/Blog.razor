@page "/blog"
@using System.Web
@using codeTopGBlazorWasm.Models
@using codeTopGBlazorWasm.Components
@inject IJSRuntime jsRuntime

<PageTitle>My Blog</PageTitle>

<button @onclick="getData" class="btn-primary">Get Blog</button>
@if (hashnodeData is null)
{
    <p>No data</p>

}
else
{
    @foreach (var item in hashnodeData.data.user.publication.posts)
    {
        <div class="container d-grid gap-3">
            <div class="row p-2 bg-light border">
                <div class="col-lg-3">
                    <img src="@item.coverImage.ToString()" class="img-fluid">
                </div>
                <div class="col-lg-9">
                    <div class="card-text p-2 bg-light border text-md-center fw-bold">
                        @item.title
                    </div>
                    <div class="card-body">
                        @item.brief
                    </div>
                    
                    
                    <div class="card-body">
                        
                         <p @onclick=ToggleReadMore>read more...</p>
                         @if (readmore==true)
                        {
                            
                            <PostContent Content="@item.contentMarkdown"
                            Slug="@item.slug"></PostContent>                            
                        }
                        

                    </div>
                </div>
            </div>
        </div>
    }
}


@code {
    private HashNodeModel? hashnodeData;
    private bool readmore = false;
   


    private void ToggleReadMore() 
    {
        readmore = !readmore;
    }

    private async Task getData()
    {
        hashnodeData = await jsRuntime.InvokeAsync<HashNodeModel>("getHashNodeInterop.getData");
        //Console.WriteLine("data from get" + hashnodeData);
        

    }

    //protected override void OnInitialized()
    //{
    //    getData();
    //}

    

}
